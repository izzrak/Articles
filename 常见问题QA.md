# 人脸识别项目深度学习部分常见问题QA

## 识别系统流程部分

### 识别流程都有哪些步骤？
整个人脸识别流程包含如下几个部分：图像采集，图像预处理，人脸检测，人脸特征提取，特征的识别或者比对。
- 图像采集：图像采集主要依靠网络摄像头对环境进行采集，通过网络串流的方式实现采集端对处理端的传输。目前的框架内对于摄像头的采集主要依靠对OpenCV中的CV::VideoCapture函数的调用，实现图像的采集与解码。
- 图像预处理：从OpenCV读取后的图像通常是为一个三维矩阵，总数据量`通道数*长*宽`，每个像素的数据类型为单精度浮点。图像的预处理工作通常会集成在深度学习框架中，工作的内容包括，输入尺寸的压缩，输入数据精度的处理，去平均值等。
- 图像检测：在输入图像完成预处理后，送入神经网络模型进行人脸检测，根据检测模型的类型，对输入输出图片进行特征提取。之后使用提取后的特征进行包围盒预测后运算，得到包含检测目标的方框坐标，以及置信概率。通过检测出的人脸坐标，对原图进行裁剪，得到只包含人脸的部分，送入人脸识别模块进行识别运算。
- 人脸识别：在得到截取后的人脸图片后，同样对其进行尺寸的缩放。之后在人脸识别的神经网络模型中经过特征提取，特征的空间嵌入，以及嵌入后的特征编码三步运算后，得到一组多维向量(在facenet模型下为128维)。通过对向量之间的距离进行计算来确定两个样本(人脸)的相似度。

### 识别系统的输入和输出分别是什么？
- 输入数据：根据目前的资源，可对照片或者视频中的一帧画面进行检测。检测模型能够操作的数据为具有BGR的三个通道的三维矩阵，YUV编码的视频则需要转化为RGB编码。例如摄像头拍摄了一组H.264的视频，在送入识别模型前，需要通过OpenCV配合FFMpeg对视频进行解码，再使用cap.Read()对其每一帧进行抽取。
- 输出数据：在facenet模型下，通过卷积计算将人脸的特征编为128维的向量编码。可以根据产品需要，通过对人脸中的全部128维向量机型分类操作，可以实现人脸的分类，如果需要完成人脸的识别，则需要使用比对操作，或者其他的算法对向量进行操作。

### 识别系统的那些部分涉及硬件加速？
所有可以并行化的部分，在神经网络模型中，卷积的计算，激活函数的计算(ReLU)，池化，批归一化这些层都可以实现并行化。而在后处理中，极大值抑制(NMS)也可以通过并行化加速。

## 卷积神经网络构架部分

### 目前的项目中都包含了哪些卷积神经网络模型？
- 人脸检测：MTCNN
- 人脸识别：facenet

### 这些神经网络模型都有什么作用？
不同的网络分别负责不同的指责，例如在MTCNN中，整个网络分为三个模组，分别实现目标区域生成，区域精细化，预测输出的三个功能。而在facenet中，resnet负责特征提取，后面的卷积网络实现特征嵌入。目前特征提取网络为比较通用的前置模型，很多检测或者识别的模型都依靠这些网络去提取特征。

## 卷积神经网络实现部分

### 神经网络中的卷积是一种怎样的操作？
神经网络里面的卷积与通信算法中的卷积类似，通过对一个输入序列或者二维矩阵的点，与特定的卷积核相乘并求和的方式得到输入序列或二维矩阵的时间或空间特征的方法。
### 卷积的种类有哪些？
根据输入的特性，分为时域卷积和空间卷积。时域卷积对一个序列进行操作，空间卷积对二维矩阵甚至多维空间矩阵进行操作。
### 人脸识别中的卷积的操作中都涉及哪些参数
- 卷积核： 卷积核实际上为一个权重的分布，根据需要提取的特征，在图片的每个区域中进行权重的计算。卷积核的尺寸通常很小，长度为奇数，且为正方形。目前常用卷积核大小为1x1，3x3，而大于3x3的卷积运算可以通过进行多次3x3卷积来拟合。从而节省计算量。
- 步长： 完成一次卷积操作后，移动到下一个点所移动的距离叫做步长。当步长大于1时，可以实现对被卷积矩阵的下采样。
- 边缘填充长度： 由于卷积核大小不为1x1时，在图像边缘无法实现卷积，那么在边缘部分填充0则可以实现对图像边缘信息的保存。通常填充0的个数由卷积核的大小决定，3x3的卷积核在边缘填充1层0，5x5的卷积核在边缘填充2层0。


## 常用英文名词解释
深度学习中有很多英文名词都具有一个简化的缩写，便于交流。

### ReLU
ReLU的全称为线性整流函数（Rectified Linear Unit, ReLU）,又称修正线性单元, 是一种人工神经网络中常用的激活函数，通常指代以斜坡函数及其变种为代表的非线性函数。
### MTCNN
MTCNN全称为多任务级联卷积神经网络(Multitask Cascaded Convolutional Networks)，通过将三个网络级联，实现高召回率，高精准度的人脸的检测，同时得到人脸关键部位的坐标。
### facenet
facenet是一种通过将人脸特征进行提取，空间嵌入编码，并使用SVM分类器将人脸进行分类，从而实现人脸识别的模型。
### NMS
NMS全称为(Non-Maximum Suppression)，通过计算两组包围盒的交并比(IOU)，对多余的包围盒进行筛选。

